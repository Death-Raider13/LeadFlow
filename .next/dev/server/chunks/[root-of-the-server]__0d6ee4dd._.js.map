{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Downloads/LeadFlow/lib/supabase/server.ts"],"sourcesContent":["import { createServerClient } from \"@supabase/ssr\"\nimport { cookies } from \"next/headers\"\n\nexport async function createClient() {\n  const cookieStore = await cookies()\n\n  return createServerClient(process.env.NEXT_PUBLIC_SUPABASE_URL!, process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!, {\n    cookies: {\n      getAll() {\n        return cookieStore.getAll()\n      },\n      setAll(cookiesToSet) {\n        try {\n          cookiesToSet.forEach(({ name, value, options }) => cookieStore.set(name, value, options))\n        } catch {\n          // The \"setAll\" method was called from a Server Component.\n        }\n      },\n    },\n  })\n}\n"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;;;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IAEjC,OAAO,IAAA,iMAAkB,sUAAoF;QAC3G,SAAS;YACP;gBACE,OAAO,YAAY,MAAM;YAC3B;YACA,QAAO,YAAY;gBACjB,IAAI;oBACF,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,GAAK,YAAY,GAAG,CAAC,MAAM,OAAO;gBAClF,EAAE,OAAM;gBACN,0DAA0D;gBAC5D;YACF;QACF;IACF;AACF"}},
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Downloads/LeadFlow/lib/plans.ts"],"sourcesContent":["export interface Plan {\n  id: string\n  name: string\n  description: string\n  priceMonthly: number\n  priceYearly: number\n  features: string[]\n  emailCredits: number\n  smsCredits: number\n  leadLimit: number | null\n  paystackPlanCodes?: {\n    monthly?: string\n    yearly?: string\n  }\n  highlighted?: boolean\n}\n\nexport const PLANS: Plan[] = [\n  {\n    id: \"free\",\n    name: \"Free\",\n    description: \"Perfect for getting started\",\n    priceMonthly: 0,\n    priceYearly: 0,\n    emailCredits: 50,\n    smsCredits: 20,\n    leadLimit: 100,\n    features: [\n      \"Up to 100 leads/month\",\n      \"50 emails/month\",\n      \"20 WhatsApp messages/month\",\n      \"Basic analytics\",\n      \"Lead capture forms\",\n    ],\n  },\n  {\n    id: \"starter\",\n    name: \"Starter\",\n    description: \"For growing businesses\",\n    // NGN 5,000/month, yearly with ~20% discount (12 * 5000 * 0.8 = 48,000)\n    priceMonthly: 5000,\n    priceYearly: 48000,\n    emailCredits: 300,\n    smsCredits: 150,\n    leadLimit: 1000,\n    paystackPlanCodes: {\n      monthly: \"PLN_0qpdsze9g1wyx8n\", // replace with your real Paystack plan code\n      yearly: \"PLN_zom6by8dep9kce3\", // replace with your real Paystack plan code\n    },\n    features: [\n      \"Up to 1,000 leads/month\",\n      \"300 emails/month\",\n      \"150 WhatsApp messages/month\",\n      \"Advanced analytics\",\n      \"CSV import/export\",\n      \"Email templates\",\n    ],\n  },\n  {\n    id: \"pro\",\n    name: \"Pro\",\n    description: \"For scaling teams\",\n    // NGN 10,000/month, yearly with ~20% discount (12 * 10000 * 0.8 = 96,000)\n    priceMonthly: 10000,\n    priceYearly: 96000,\n    emailCredits: 500,\n    smsCredits: 500,\n    leadLimit: null,\n    paystackPlanCodes: {\n      monthly: \"PLN_wzel3treojqbl04\", // replace with your real Paystack plan code\n      yearly: \"PLN_1ezppnexsor12t2\", // replace with your real Paystack plan code\n    },\n    highlighted: true,\n    features: [\n      \"Unlimited leads generation\",\n      \"500 emails/month\",\n      \"500 WhatsApp messages/month\",\n      \"Priority support\",\n      \"Custom branding\",\n      \"API access\",\n      \"Team collaboration\",\n    ],\n  },\n]\n"],"names":[],"mappings":";;;;AAiBO,MAAM,QAAgB;IAC3B;QACE,IAAI;QACJ,MAAM;QACN,aAAa;QACb,cAAc;QACd,aAAa;QACb,cAAc;QACd,YAAY;QACZ,WAAW;QACX,UAAU;YACR;YACA;YACA;YACA;YACA;SACD;IACH;IACA;QACE,IAAI;QACJ,MAAM;QACN,aAAa;QACb,wEAAwE;QACxE,cAAc;QACd,aAAa;QACb,cAAc;QACd,YAAY;QACZ,WAAW;QACX,mBAAmB;YACjB,SAAS;YACT,QAAQ;QACV;QACA,UAAU;YACR;YACA;YACA;YACA;YACA;YACA;SACD;IACH;IACA;QACE,IAAI;QACJ,MAAM;QACN,aAAa;QACb,0EAA0E;QAC1E,cAAc;QACd,aAAa;QACb,cAAc;QACd,YAAY;QACZ,WAAW;QACX,mBAAmB;YACjB,SAAS;YACT,QAAQ;QACV;QACA,aAAa;QACb,UAAU;YACR;YACA;YACA;YACA;YACA;YACA;YACA;SACD;IACH;CACD"}},
    {"offset": {"line": 151, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Downloads/LeadFlow/app/api/stripe/create-checkout/route.ts"],"sourcesContent":["import { type NextRequest, NextResponse } from \"next/server\"\nimport { createClient } from \"@/lib/supabase/server\"\nimport { PLANS } from \"@/lib/plans\"\n\nfunction getBaseUrl(request: NextRequest): string {\n  // Try origin header first\n  const origin = request.headers.get(\"origin\")\n  if (origin && origin.startsWith(\"http\")) {\n    return origin\n  }\n\n  // Try host header with protocol detection\n  const host = request.headers.get(\"host\")\n  const protocol = request.headers.get(\"x-forwarded-proto\") || \"https\"\n  if (host) {\n    return `${protocol}://${host}`\n  }\n\n  // Fallback to referer\n  const referer = request.headers.get(\"referer\")\n  if (referer) {\n    const url = new URL(referer)\n    return url.origin\n  }\n\n  // Last resort fallback\n  return \"https://localhost:3000\"\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    const supabase = await createClient()\n    const {\n      data: { user },\n    } = await supabase.auth.getUser()\n\n    if (!user) {\n      return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 })\n    }\n\n    const { planId, billingCycle, email } = await request.json()\n\n    const plan = PLANS.find((p) => p.id === planId)\n    if (!plan || plan.id === \"free\") {\n      return NextResponse.json({ error: \"Invalid plan\" }, { status: 400 })\n    }\n    const baseUrl = getBaseUrl(request)\n    const amount = (billingCycle === \"yearly\" ? plan.priceYearly : plan.priceMonthly) * 100\n\n    const planCode =\n      billingCycle === \"yearly\" ? plan.paystackPlanCodes?.yearly : plan.paystackPlanCodes?.monthly\n\n    const secretKey = process.env.PAYSTACK_SECRET_KEY\n    if (!secretKey) {\n      return NextResponse.json({ error: \"PAYSTACK_SECRET_KEY is not configured\" }, { status: 500 })\n    }\n\n    const payload: any = {\n      email,\n      amount,\n      currency: \"NGN\",\n      callback_url: `${baseUrl}/dashboard/billing`,\n      metadata: {\n        userId: user.id,\n        planId: plan.id,\n        billingCycle,\n      },\n    }\n\n    if (planCode) {\n      payload.plan = planCode\n    }\n\n    const initializeResponse = await fetch(\"https://api.paystack.co/transaction/initialize\", {\n      method: \"POST\",\n      headers: {\n        Authorization: `Bearer ${secretKey}`,\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify(payload),\n    })\n\n    if (!initializeResponse.ok) {\n      const errorText = await initializeResponse.text()\n      console.error(\"Paystack initialize error:\", errorText)\n      return NextResponse.json({ error: \"Failed to create checkout session\" }, { status: 500 })\n    }\n\n    const initializeData = (await initializeResponse.json()) as {\n      status: boolean\n      message: string\n      data?: { authorization_url?: string | null }\n    }\n\n    if (!initializeData.status || !initializeData.data?.authorization_url) {\n      console.error(\"Paystack initialize response error:\", initializeData)\n      return NextResponse.json({ error: \"Failed to create checkout session\" }, { status: 500 })\n    }\n\n    return NextResponse.json({ url: initializeData.data.authorization_url })\n  } catch (error) {\n    console.error(\"Paystack checkout error:\", error)\n    return NextResponse.json({ error: \"Failed to create checkout session\" }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":"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"}}]
}